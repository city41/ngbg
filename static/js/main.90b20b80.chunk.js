(window.webpackJsonpngbg=window.webpackJsonpngbg||[]).push([[0],{11:function(e,t,r){e.exports={root:"spriteTray_root__1Sixf",message:"spriteTray_message__21tFc",spriteEntries:"spriteTray_spriteEntries__16oai",filler:"spriteTray_filler__K67QZ"}},12:function(e,t,r){e.exports={app:"app_app__cewju",composeScreenTrayGrid:"app_composeScreenTrayGrid__3746Z",composeScreen:"app_composeScreen__1Kdh-",spriteTray:"app_spriteTray__kqjfe",emulatorLayersGrid:"app_emulatorLayersGrid__cLX2s",emulator:"app_emulator__3kFZf",layers:"app_layers__3kgZm"}},17:function(e,t,r){e.exports={root:"cropRect_root__LYSAR",mask:"cropRect_mask__Vl5ZD",crop:"cropRect_crop__2ev0N"}},23:function(e,t,r){e.exports={root:"spriteEntry_root__21-Rc",index:"spriteEntry_index__3_j9A",focused:"spriteEntry_focused__2e2R9",spriteContainer:"spriteEntry_spriteContainer__3BESY"}},24:function(e,t,r){e.exports={root:"composeScreen_root__3bwon",toolbar:"composeScreen_toolbar__1QlS0",bg:"composeScreen_bg__1xmrl",captureLayer:"composeScreen_captureLayer__1AfVW",cropRect:"composeScreen_cropRect__3Yoa2"}},31:function(e,t,r){e.exports={root:"group_root__1RKod",toolbar:"group_toolbar__1l8sD",spriteContainer:"group_spriteContainer__cQlrm"}},35:function(e,t,r){e.exports={root:"extractedTile_root__14wnu",outlined:"extractedTile_outlined__1tGwy"}},36:function(e,t,r){e.exports={root:"emulator_root__3kH7Z",pauseOverlay:"emulator_pauseOverlay__2scVp"}},37:function(e,t,r){e.exports={root:"layer_root__NdbK1",toolbar:"layer_toolbar__1mN6V"}},38:function(e,t,r){e.exports={root:"layers_root__1VIq8"}},46:function(e,t,r){e.exports={root:"extractedSprite_root__gpe6g"}},47:function(e,t,r){e.exports={root:"pauseOverlay_root__1NZLe"}},50:function(e,t,r){e.exports={canvas:"tile_canvas__1tNqN"}},51:function(e,t,r){e.exports={sprite:"sprite_sprite__38hI5"}},52:function(e,t,r){e.exports={root:"layer_root__1yNTP"}},53:function(e,t,r){e.exports={root:"iconButton_root__J-591"}},54:function(e,t,r){e.exports={root:"sprite_root__1RSYf"}},57:function(e,t,r){e.exports=r(80)},78:function(e,t,r){},80:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(19),i=r.n(o),c=r(33),u=r.n(c),s=r(8),l=r(22),p=r(2),f=r(3),d=r(4),m=1;function y(){return m++}var g=r(15);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(r,!0).forEach(function(t){Object(d.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function b(e){var t,r;return r=e,0===(t=Array.isArray(r)&&(0===r.length||"composedX"in r[0])?e.reduce(function(e,t){return e.concat(t.tiles)},[]):e).length?0:Math.max.apply(Math,Object(f.a)(t.map(function(e){return e.composedY})))}function w(e){return 0===e.length?0:Math.min.apply(Math,Object(f.a)(e.map(function(e){return e.composedY})))}function O(e){return 0===e.length?0:Math.max.apply(Math,Object(f.a)(e.map(function(e){return e.composedX})))}function E(e){return 0===e.length?0:Math.min.apply(Math,Object(f.a)(e.map(function(e){return e.composedX})))}function j(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"composedX";return e.map(function(e){return h({},e,{composedX:e[n]+t,tiles:0===r?e.tiles:C(e.tiles,r)})})}function _(e,t,r,n){return e.map(function(e){return"number"===typeof n&&e.pauseId!==n?e:h({},e,{sprites:j(e.sprites,t,r)})})}function x(e){var t=w(P(e));return t>=0?e:e.map(function(e){return h({},e,{groups:(r=e.groups,n=-1*t,r.map(function(e){return h({},e,{sprites:M(e.sprites,n)})}))});var r,n})}function P(e){return S(e).reduce(function(e,t){return e.concat(t.tiles)},[])}function S(e){return e.reduce(function(e,t){return e.concat(t.groups.reduce(function(e,t){return e.concat(t.sprites)},[]))},[])}function I(e){return e.reduce(function(e,t){return e.concat(t.tiles)},[])}function M(e,t){return e.map(function(e){return h({},e,{tiles:C(e.tiles,t)})})}function C(e,t){return e.map(function(e){return h({},e,{composedY:e.composedY+t})})}function D(e,t){var r=e.reduce(function(e,t){return e.concat(t.sprites)},[]),n=function(e){var t=O(e);return e.map(function(e){return h({},e,{spriteMemoryIndex:e.spriteMemoryIndex,composedX:2*t-(e.composedX+16),tiles:e.tiles.map(function(e){return h({},e,{horizontalFlip:!e.horizontalFlip})})})}).reverse()}(r),a=function(e){var t=E(e),r=O(e)+16,n=r-t;return e.map(function(e){return h({},e,{spriteMemoryIndex:e.spriteMemoryIndex,composedX:t-n+(r-(e.composedX+16)),tiles:e.tiles.map(function(e){return h({},e,{horizontalFlip:!e.horizontalFlip})})})}).reverse()}(r);return[{id:y(),pauseId:t,sprites:a},{id:y(),pauseId:t,sprites:n}]}function k(e){var t=E(e.sprites),r=w(I(e.sprites));return 0===t&&0===r?e:h({},e,{sprites:j(e.sprites,-t,-r)})}function N(e){var t=E(S([e])),r=w(P([e]));return 0===t&&0===r?e:h({},e,{groups:_(e.groups,-t,-r)})}var F=r(29),T={0:3,1:2,2:1,3:0,4:7,5:6,6:5,7:4},B=Object(g.memoize)(function(e){for(var t=window.Module._get_rom_ctile_addr(),r=128*e,n=[],a=0;a<128;++a)n[a]=window.HEAPU8[t+r+a];for(var o=[],i=0;i<16;++i)for(var c=0;c<8;++c){var u=n[8*i+T[c]],s=u>>4&15,l=15&u;o.push(s,l)}return o});function A(e,t,r){var n=B(t);e.width=16,e.height=16;for(var a=e.getContext("2d"),o=a.getImageData(0,0,16,16),i=0;i<16;++i)for(var c=0;c<16;++c)for(var u=r[n[16*i+c]],s=0;s<u.length;++s)o.data[4*(16*i+c)+s]=u[s];a.putImageData(o,0,0)}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var L=128,G=65536,Y=66560,z=67584;function X(e){if(e<0)throw new Error("getYSpriteSizeSticky: sprite index under zero!");var t=window.Module._get_tile_ram_addr()+Y+2*e,r=window.HEAPU8[t]|window.HEAPU8[t+1]<<8,n=!!(r>>6&1);if(n)return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(r,!0).forEach(function(t){Object(d.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},X(e-1),{sticky:n});for(var a=63&r,o=function(e,t,r){var n,a=512-e;if(a>272&&(a-=512),2===(n=32===r?1:r>=33?2:0)||1===n&&255===t)for(;a<0;)a+=t+1<<1;return a}(r>>7,V(e,{ignoreSticky:!0}).yScale,a),i=[],c=0;c<a;++c)i.push((o+16*c)%512);return{y:o,tileYs:i,spriteSize:a,sticky:n}}function U(e){if(e<0)throw new Error("getX: sprite index under zero!");var t;if(X(e).sticky){var r=V(e).xScale;t=U(e-1)+r}else{var n=window.Module._get_tile_ram_addr()+z+2*e;t=(window.HEAPU8[n]|window.HEAPU8[n+1]<<8)>>7}return t>=496&&(t-=512),t}function V(e,t){if(e<0)throw new Error("getScale: sprite index under zero!");if((!t||!t.ignoreSticky)&&X(e).sticky)return V(e-1);var r=window.Module._get_tile_ram_addr()+G+2*e,n=window.HEAPU8[r]|window.HEAPU8[r+1]<<8;return{yScale:255&n,xScale:1+(n>>8&15)}}function H(e){var t=X(e),r=t.sticky,n=t.y,a=t.tileYs,o=t.spriteSize;return{spriteMemoryIndex:e,tiles:function(e,t,r){for(var n=window.Module._get_tile_ram_addr(),a=L*e,o=[],i=0;i<4*t;++i)o[i]=window.HEAPU8[n+a+i];for(var c=[],u=0;u<o.length;u+=4){var s=o[u]|o[u+1]<<8,l=o[u+2]|o[u+3]<<8,p=s|(l>>4&15)<<16,f=0;8&l?f=3:4&l&&(f=2);var d=l>>8&255,m=!!(1&l),y=!!(2&l);c.push({y:r[u/4],tileIndex:p,paletteIndex:d,horizontalFlip:m,verticalFlip:y,autoAnimation:f})}return c}(e,o,a),x:U(e),sticky:r,y:n,spriteSize:o}}var Z=16,q=2*Z;function K(e){var t=e>>15&1;return[((e>>8&15)<<2|(e>>14&1)<<1|t)/63*255,((e>>4&15)<<2|(e>>13&1)<<1|t)/63*255,((15&e)<<2|(e>>12&1)<<1|t)/63*255,255]}function Q(e){var t=(window.Module._get_current_pal_addr()+e*q)/2;return Object(f.a)(window.Module.HEAPU16.slice(t,t+Z))}function W(e){var t=e.map(K);return[[0,0,0,0]].concat(Object(f.a)(t.slice(1)))}function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(r,!0).forEach(function(t){Object(d.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ee(e){var t=e.y,r=(e.paletteIndex,Object(F.a)(e,["y","paletteIndex"])),n=Q(e.paletteIndex);return $({},r,{composedY:t,neoGeoPalette:n,rgbPalette:W(n)})}function te(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return re(function(e){for(var t=e,r=H(t);r.sticky&&t>0;)r=H(t-=1);var n=[];do{n.push(t),r=H(t+=1)}while(r.sticky);return n}(e),t,r,n)}function re(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=e.map(function(e,a){var o=H(e);return $({},n,{pauseId:r,spriteMemoryIndex:e,tiles:o.tiles.map(ee),screenX:o.x,screenY:o.y,composedX:t+16*a,composedY:o.y})});return{id:y(),pauseId:r,sprites:a}}function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ae(e,t,r){return t.map(function(t){return t===e?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(r,!0).forEach(function(t){Object(d.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e,{},r):t})}function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(r,!0).forEach(function(t){Object(d.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ce(e,t,r){return 0===e.length?e:e.map(function(e){var n=e.composedY>=r,a=e.composedY-r;return ie({},e,{composedY:n?t+a:e.composedY+16})})}function ue(e,t,r){return e.map(function(e){return ie({},e,{tiles:ce(e.tiles,t,r)})})}function se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?se(r,!0).forEach(function(t){Object(d.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):se(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var pe,fe=(pe=function(e,t,r){switch(t.type){case"ExtractSpritesToGroup":case"ExtractSprite":var n;if("spriteMemoryIndex"in t){var a=t.spriteMemoryIndex,o=t.composedX;n=te(a,o,r.pauseId)}else{var i=t.spriteMemoryIndices,c=t.composedX;n=re(i,c,r.pauseId,{isAdhoc:!0})}var u=Object(f.a)(e.layers).reverse().find(function(e){return!r.hiddenLayers[e.id]})||{id:y(),groups:[n]},s=u.groups.filter(function(e){return e.pauseId!==n.pauseId||!function(e,t){var r=e.sprites.map(function(e){return e.spriteMemoryIndex}).sort(),n=t.sprites.map(function(e){return e.spriteMemoryIndex}).sort();return Object(g.isEqual)(r,n)}(e,n)});return n=function(e,t){var r=t.find(function(t){return t.pauseId===e.pauseId});if(!r)return e;var n=r.sprites[0].composedX-r.sprites[0].screenX;return h({},e,{sprites:j(e.sprites,n,0,"screenX")})}(n,s),ie({},e,{layers:0===e.layers.length?[u]:ae(u,e.layers,{groups:[].concat(Object(f.a)(u.groups),[n])})});case"MoveSprite":var l=t.spriteMemoryIndex,d=t.newComposedX,m=t.pauseId,v=e.layers.find(function(e){return e.groups.some(function(e){return e.sprites.some(function(e){return e.spriteMemoryIndex===l&&e.pauseId===m})})});if(!v)return e;var b=v.groups.find(function(e){return e.pauseId===m&&e.sprites.some(function(e){return e.spriteMemoryIndex===l})});if(!b)return e;var w=d-b.sprites[0].composedX,O=_(v.groups,w,m);return ie({},e,{layers:ae(v,e.layers,{groups:O})});case"DeleteGroup":var I=t.group,M=e.layers.find(function(e){return e.groups.indexOf(I)>-1});if(!M)throw new Error("DeleteGroup: can't find the layer this group belongs to");var C=Object(g.without)(M.groups,I);return ie({},e,{layers:ae(M,e.layers,{groups:C})});case"NewLayer":var k={id:y(),groups:[],hidden:!1};return ie({},e,{layers:[].concat(Object(f.a)(e.layers),[k])});case"DeleteLayer":var N=t.layer;return ie({},e,{layers:e.layers.filter(function(e){return e!==N})});case"ExtendLayerViaMirror":var F=t.layer;if(0===F.groups.length)return e;var T,B=D(F.groups,r.pauseId),A={id:y(),groups:B,hidden:!1},R=e.layers.indexOf(F);return T=0===R?[A].concat(Object(f.a)(e.layers)):[].concat(Object(f.a)(e.layers.slice(0,R-1)),[A],Object(f.a)(e.layers.slice(R-1))),ie({},e,{layers:T=function(e){var t=E(S(e));return t>=0?e:e.map(function(e){return h({},e,{groups:(r=e.groups,n=-1*t,r.map(function(e){return h({},e,{sprites:j(e.sprites,n,0)})}))});var r,n})}(T)});case"RemoveSpriteFromExtractedGroup":var L=t.group,G=t.sprite,Y=e.layers.find(function(e){return e.groups.indexOf(L)>-1});if(!Y)throw new Error("RemoveSpriteFromExtractedGroup: cant find layer for group");var z=ae(L,Y.groups,{sprites:Object(g.without)(L.sprites,G)});return ie({},e,{layers:ae(Y,e.layers,{groups:z})});case"RotateLayer":var X=t.layer,U=ae(X,e.layers,function(e,t){var r=P(t),n=r.reduce(function(e,t){return t.composedY<e&&t.composedY%16===0?t.composedY:e},1/0);if(n===1/0)return e;var a=r.reduce(function(e,t){return t.composedY>e&&t.composedY%16===0?t.composedY:e},-1/0);if(a===-1/0)return e;var o=e.groups.map(function(e){return ie({},e,{sprites:ue(e.sprites,n,a)})});return ie({},e,{groups:o})}(X,e.layers));return ie({},e,{layers:U});case"PushDownLayer":var V=t.layer,H=x([V]),Z=Object(p.a)(H,1)[0];return ie({},e,{layers:ae(V,e.layers,Z)});case"PushAllDown":return ie({},e,{layers:x(e.layers)})}},{initialState:{past:[],present:{layers:[]},future:[],hasStarted:!1,isPaused:!1,pauseId:0,crop:void 0,showGrid:!1,hiddenLayers:{},hiddenGroups:{}},reducer:function(e,t){var r;switch(t.type){case"StartEmulation":return le({},e,{hasStarted:!0});case"TogglePause":var n=!e.isPaused;return le({},e,{isPaused:n,pauseId:n?e.pauseId+1:e.pauseId});case"ToggleGrid":return le({},e,{showGrid:!e.showGrid});case"SetCrop":return le({},e,{crop:t.crop});case"ClearCrop":return le({},e,{crop:void 0});case"ToggleVisibilityOfGroup":var a=t.group;return le({},e,{hiddenGroups:le({},e.hiddenGroups,Object(d.a)({},a.id,!e.hiddenGroups[a.id]))});case"ToggleVisibilityOfLayer":var o=t.layer;return le({},e,{hiddenLayers:le({},e.hiddenLayers,Object(d.a)({},o.id,!e.hiddenLayers[o.id]))});case"undo":var i=Object(f.a)(e.past),c=i.pop();if(!c)throw new Error("undo: nothing to undo!");r=le({},e,{past:i,present:c,future:[].concat(Object(f.a)(e.future),[e.present])});break;case"redo":var u=Object(f.a)(e.future),s=u.pop();if(!s)throw new Error("redo: nothing to redo!");r=le({},e,{past:[].concat(Object(f.a)(e.past),[e.present]),present:s,future:u});break;default:r=le({},e,{past:[].concat(Object(f.a)(e.past),[e.present]),present:pe(e.present,t,e)})}return r}}),de=fe.initialState,me=fe.reducer,ye=Object(n.createContext)(de),ge=Object(n.createContext)(function(){return 0}),ve=function(e){var t=e.children,r=Object(n.useReducer)(me,de),o=Object(p.a)(r,2),i=o[0],c=o[1];return a.a.createElement(ge.Provider,{value:c},a.a.createElement(ye.Provider,{value:i},t))},he=r(5),be=r.n(he),we=r(35),Oe=r.n(we),Ee=a.a.memo(function(e){var t=e.y,r=e.tileIndex,n=e.rgbPalette,o=e.horizontalFlip,i=e.verticalFlip,c=e.outlined;var u=o?-1:1,s=i?-1:1,l=be()(Oe.a.root,Object(d.a)({},Oe.a.outlined,c)),p={transform:"scale(".concat(u,",").concat(s,")"),top:t};return a.a.createElement("canvas",{className:l,"data-tileindex":r,ref:function(e){return e&&void A(e,r,n)},style:p})}),je=r(46),_e=r.n(je),xe=function(e){var t=e.data,r=e.autoAnimate,o=e.animationCounter,i=e.canDrag,c=e.outlineTiles,u=e.setYToZero,f=e.overrideX,d=Object(s.c)({item:{spriteMemoryIndex:t.spriteMemoryIndex,pauseId:t.pauseId,type:"Sprite",isAdhoc:t.isAdhoc},canDrag:function(){return i}}),m=Object(p.a)(d,3),y=(m[0],m[1]),g=m[2];Object(n.useEffect)(function(){g(Object(l.b)(),{captureDraggingState:!0})},[g]);var v=t.tiles.map(function(e,n){var i=e.tileIndex;return r&&"number"===typeof o&&(3===e.autoAnimation&&(i=(-8&i)+(i+o&7)),2===e.autoAnimation&&(i=(-4&i)+(i+o&3))),a.a.createElement(Ee,{key:n,y:e.composedY-t.composedY,tileIndex:i,rgbPalette:e.rgbPalette,horizontalFlip:e.horizontalFlip,verticalFlip:e.verticalFlip,outlined:c})}),h={top:u?0:t.composedY,left:"number"===typeof f?f:t.composedX,gridTemplateRows:"repeat(".concat(t.tiles.length,", 16px)"),zIndex:t.spriteMemoryIndex};return a.a.createElement("div",{ref:y,className:_e.a.root,style:h},v)},Pe=a.a.memo(function(e){var t=te(e.seedSpriteMemoryIndex,0,0).sprites.map(function(e,t){return a.a.createElement(xe,{key:t,data:e,canDrag:!1,setYToZero:!0})});return a.a.createElement("div",null,t)}),Se=a.a.memo(function(e){var t=re(e.spriteMemoryIndices,0,0).sprites.map(function(e,t){return a.a.createElement(xe,{key:t,data:e,canDrag:!1,setYToZero:!0})});return a.a.createElement("div",null,t)}),Ie=function(){var e=Object(s.d)(function(e){return{item:e.getItem(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:e.getClientOffset(),isDragging:e.isDragging()}}),t=e.isDragging,r=e.item,n=e.currentOffset;if(!t||!n||"Sprite"!==r.type&&"Sprites"!==r.type)return null;var o,i={position:"fixed",top:n.y+4,left:n.x+4,zIndex:1e3};return o="Sprite"!==r.type||r.isAdhoc?"Sprite"===r.type&&r.isAdhoc?a.a.createElement(Se,{spriteMemoryIndices:[r.spriteMemoryIndex]}):a.a.createElement(Se,{spriteMemoryIndices:r.spriteMemoryIndices}):a.a.createElement(Pe,{seedSpriteMemoryIndex:r.spriteMemoryIndex}),a.a.createElement("div",{style:i},o)};function Me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ce(){var e=Object(n.useContext)(ge),t=Object(n.useContext)(ye),r=(t.past,t.present,t.future,Object(F.a)(t,["past","present","future"]));return{state:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Me(r,!0).forEach(function(t){Object(d.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Me(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},t.present,{},r),dispatch:e,undo:function(){e({type:"undo"})},redo:function(){e({type:"redo"})},canUndo:t.past.length>0,canRedo:t.future.length>0}}var De=r(16),ke=r.n(De),Ne=r(30);function Fe(e){return new Promise(function(t,r){var n=new FileReader;n.addEventListener("load",function(){n.result?t(n.result):r("Failed to load: ".concat(e.name))}),n.readAsArrayBuffer(e)})}function Te(e){return Be.apply(this,arguments)}function Be(){return(Be=Object(Ne.a)(ke.a.mark(function e(t){var r;return ke.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe(t);case 2:r=e.sent,window.Module.FS_createDataFile("/virtualfs",t.name,new Uint8Array(r),!0,!0);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ae=function(){var e=Object(n.useState)(!0),t=Object(p.a)(e,2),r=t[0],o=t[1],c=Object(n.useState)(""),u=Object(p.a)(c,2),s=u[0],l=(u[1],Object(n.useState)(!1)),f=Object(p.a)(l,2),d=f[0],m=f[1],y=Ce().dispatch;function g(){return(g=Object(Ne.a)(ke.a.mark(function e(t){var r;return ke.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.target&&t.target.files&&t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Te(r);case 5:m(!0),s&&h(s);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v(){return(v=Object(Ne.a)(ke.a.mark(function e(t){var r,n;return ke.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.target&&t.target.files&&t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Te(r);case 5:n=r.name.replace(".zip",""),d&&h(n);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(e){var t=window.stackAlloc(12);window.HEAP32[t>>2]=window.allocateUTF8OnStack("gngeo"),window.HEAP32[1+(t>>2)]=window.allocateUTF8OnStack(e||s),window.HEAP32[2+(t>>2)]=0,o(!1),y({type:"StartEmulation"});try{window.Module._run_rom(2,t)}catch(r){console.log("_run_rom threw")}}return a.a.createElement(i.a,{isOpen:r},a.a.createElement("div",null,"BIOS",a.a.createElement("input",{type:"file",onChange:function(e){return g.apply(this,arguments)}})),a.a.createElement("div",null,"ROM",a.a.createElement("input",{type:"file",onChange:function(e){return v.apply(this,arguments)}})),null)},Re=r(48),Le=r.n(Re),Ge=r(49),Ye=r.n(Ge),ze=r(47),Xe=r.n(ze),Ue=function(e){var t=e.className,r=e.onTogglePause,n=e.isPaused,o=n?Le.a:Ye.a,i=be()(Xe.a.root,t);return a.a.createElement("div",{className:i,onClick:function(){return r()},title:"click to ".concat(n?"play":"pause")},a.a.createElement(o,null))},Ve=r(36),He=r.n(Ve),Ze=function(e){var t=Ce(),r=t.state,n=t.dispatch;var o=be()(He.a.root,e.className);return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ae,null),a.a.createElement("div",{className:o},a.a.createElement("canvas",{id:"canvas"}),a.a.createElement(Ue,{className:He.a.pauseOverlay,onTogglePause:function(){return r.isPaused?window.Module.resumeMainLoop():window.Module.pauseMainLoop(),void n({type:"TogglePause"})},isPaused:r.isPaused})))},qe=r(50),Ke=r.n(qe),Qe=a.a.memo(function(e){e.y;var t=e.tileIndex,r=e.paletteIndex,n=e.horizontalFlip;var o=e.verticalFlip?-1:1,i={transform:"scale(".concat(n?-1:1,",").concat(o,")")};return a.a.createElement("canvas",{className:Ke.a.canvas,ref:function(e){return e&&function(e){var n=W(Q(r));A(e,t,n)}(e)},style:i})}),We=r(51),Je=r.n(We),$e=function(e){e.className;var t=e.spriteData,r=t.spriteMemoryIndex;if(0===t.tiles.length)return null;var n=t.tiles.map(function(e,t){return a.a.createElement(Qe,{key:t,y:e.y,tileIndex:e.tileIndex,paletteIndex:e.paletteIndex,horizontalFlip:e.horizontalFlip,verticalFlip:e.verticalFlip})}),o={gridTemplateRows:"repeat(".concat(t.tiles.length,", 8px)"),zIndex:r};return a.a.createElement("div",{className:Je.a.sprite,style:o},n)},et=r(23),tt=r.n(et),rt=function(e){var t=e.className,r=e.spriteData,n=e.focused,o=e.onClick,i=be()(tt.a.root,t,Object(d.a)({},tt.a.focused,n));return a.a.createElement("div",{className:i,onClick:o},a.a.createElement("div",{className:tt.a.index},r.spriteMemoryIndex),a.a.createElement("div",{className:tt.a.spriteContainer},a.a.createElement($e,{className:tt.a.sprite,spriteData:r})))},nt=r(11),at=r.n(nt);var ot=function(e){var t=e.className,r=Ce().state,o=Object(n.useState)([]),i=Object(p.a)(o,2),c=i[0],u=i[1],f=Object(n.useState)(null),m=Object(p.a)(f,2),y=m[0],g=m[1],v=Object(n.useRef)(null),h=Object(s.c)({item:{type:"Sprite"},begin:function(e){if(_&&v&&v.current){var t=e.getClientOffset().x-_.getBoundingClientRect().left-v.current.getBoundingClientRect().width,r=Math.floor(t/8);if(c.indexOf(r)>-1)return{type:"Sprites",spriteMemoryIndices:c.map(function(e){return S[e].spriteMemoryIndex})};if(r>=0&&r<S.length)return{spriteMemoryIndex:S[r].spriteMemoryIndex,type:"Sprite"}}},canDrag:function(){return r.isPaused}}),b=Object(p.a)(h,3),w=(b[0],b[1]),O=b[2],E=Object(n.useState)(null),j=Object(p.a)(E,2),_=j[0],x=j[1];if(Object(n.useEffect)(function(){O(Object(l.b)(),{captureDraggingState:!0})},[O]),!r.isPaused){var P=be()(at.a.root,at.a.message,t);return a.a.createElement("div",{className:P},"pause the game to load the current sprites")}var S=new Array(381).fill(1,0,381).map(function(e,t){return H(t)}).filter(function(e){return e.tiles.length>0}),I=S.map(function(e,t){return a.a.createElement(rt,{key:t,spriteData:e,onClick:function(e){if(e.ctrlKey)u(c.concat(t)),g(null);else if(e.shiftKey)if(null!==y||1===c.length){var r=Math.min(y||c[0],t),n=Math.max(y||c[0],t);u(function(e,t){var r=t-e+1;return new Array(r).fill(0,0,r).map(function(t,r){return r+e})}(r,n))}else u([t]),g(t);else u([t]),g(null)},focused:c.indexOf(t)>-1})}),M=be()(at.a.root,t,Object(d.a)({},at.a.locked,!r.isPaused));return a.a.createElement("div",{className:M,ref:function(e){x(e),w(e)}},a.a.createElement("div",{key:r.pauseId,className:at.a.spriteEntries,style:{gridTemplateColumns:"1fr repeat(".concat(S.length,", max-content) 1fr")}},a.a.createElement("div",{className:at.a.filler,ref:v,style:{gridColumn:1}}),I,a.a.createElement("div",{className:at.a.filler,style:{gridColumn:S.length+2}})))},it=function(){var e,t,r,n,a,o,i,c,u,s,l,p,f={},d=-1,m=12,y=5003,g=m,v=1<<m,h=[],b=[],w=y,O=0,E=!1,j=0,_=0,x=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],P=[],S=f.LZWEncoder=function(a,o,i,c){e=a,t=o,r=i,n=Math.max(2,c)},I=function(e,t){P[p++]=e,p>=254&&k(t)},M=function(e){C(w),O=s+2,E=!0,T(s,e)},C=function(e){for(var t=0;t<e;++t)h[t]=-1},D=f.compress=function(e,t){var r,n,a,o,f,m,y;for(E=!1,c=N(i=u=e),l=(s=1<<e-1)+1,O=s+2,p=0,o=F(),y=0,r=w;r<65536;r*=2)++y;y=8-y,C(m=w),T(s,t);e:for(;(a=F())!=d;)if(r=(a<<g)+o,h[n=a<<y^o]!=r){if(h[n]>=0){f=m-n,0===n&&(f=1);do{if((n-=f)<0&&(n+=m),h[n]==r){o=b[n];continue e}}while(h[n]>=0)}T(o,t),o=a,O<v?(b[n]=O++,h[n]=r):M(t)}else o=b[n];T(o,t),T(l,t)},k=(f.encode=function(r){r.writeByte(n),a=e*t,o=0,D(n+1,r),r.writeByte(0)},function(e){p>0&&(e.writeByte(p),e.writeBytes(P,0,p),p=0)}),N=function(e){return(1<<e)-1},F=function(){return 0===a?d:(--a,255&r[o++])},T=function(e,t){for(j&=x[_],_>0?j|=e<<_:j=e,_+=i;_>=8;)I(255&j,t),j>>=8,_-=8;if((O>c||E)&&(E?(c=N(i=u),E=!1):c=++i==g?v:N(i)),e==l){for(;_>0;)I(255&j,t),j>>=8,_-=8;k(t)}};return S.apply(this,arguments),f},ct=function(){var e,t,r,n,a,o={},i=256,c=499,u=491,s=487,l=503,p=3*l,f=i-1,d=4,m=100,y=16,g=1<<y,v=10,h=10,b=g>>h,w=g<<v-h,O=i>>3,E=6,j=1<<E,_=O*j,x=30,P=10,S=1<<P,I=8,M=1<<I,C=P+I,D=1<<C,k=[],N=[],F=[],T=[],B=o.NeuQuant=function(e,o,c){var u,s;for(t=e,r=o,n=c,a=new Array(i),u=0;u<i;u++)a[u]=new Array(4),(s=a[u])[0]=s[1]=s[2]=(u<<d+8)/i,F[u]=g/i,N[u]=0},A=function(){for(var e=[],t=new Array(i),r=0;r<i;r++)t[a[r][3]]=r;for(var n=0,o=0;o<i;o++){var c=t[o];e[n++]=a[c][0],e[n++]=a[c][1],e[n++]=a[c][2]}return e},R=function(){var e,t,r,n,o,c,u,s;for(u=0,s=0,e=0;e<i;e++){for(r=e,n=(o=a[e])[1],t=e+1;t<i;t++)(c=a[t])[1]<n&&(r=t,n=c[1]);if(c=a[r],e!=r&&(t=c[0],c[0]=o[0],o[0]=t,t=c[1],c[1]=o[1],o[1]=t,t=c[2],c[2]=o[2],o[2]=t,t=c[3],c[3]=o[3],o[3]=t),n!=u){for(k[u]=s+e>>1,t=u+1;t<n;t++)k[t]=e;u=n,s=e}}for(k[u]=s+f>>1,t=u+1;t<256;t++)k[t]=f},L=function(){var a,o,i,f,y,g,v,h,b,w,O,j,P,I;for(r<p&&(n=1),e=30+(n-1)/3,j=t,P=0,I=r,w=(O=r/(3*n))/m|0,h=S,(v=(g=_)>>E)<=1&&(v=0),a=0;a<v;a++)T[a]=h*((v*v-a*a)*M/(v*v));for(b=r<p?3:r%c!==0?3*c:r%u!==0?3*u:r%s!==0?3*s:3*l,a=0;a<O;)if(i=(255&j[P+0])<<d,f=(255&j[P+1])<<d,y=(255&j[P+2])<<d,o=X(i,f,y),z(h,o,i,f,y),0!==v&&Y(v,o,i,f,y),(P+=b)>=I&&(P-=r),0===w&&(w=1),++a%w===0)for(h-=h/e,(v=(g-=g/x)>>E)<=1&&(v=0),o=0;o<v;o++)T[o]=h*((v*v-o*o)*M/(v*v))},G=(o.map=function(e,t,r){var n,o,c,u,s,l,p;for(s=1e3,p=-1,o=(n=k[t])-1;n<i||o>=0;)n<i&&((c=(l=a[n])[1]-t)>=s?n=i:(n++,c<0&&(c=-c),(u=l[0]-e)<0&&(u=-u),(c+=u)<s&&((u=l[2]-r)<0&&(u=-u),(c+=u)<s&&(s=c,p=l[3])))),o>=0&&((c=t-(l=a[o])[1])>=s?o=-1:(o--,c<0&&(c=-c),(u=l[0]-e)<0&&(u=-u),(c+=u)<s&&((u=l[2]-r)<0&&(u=-u),(c+=u)<s&&(s=c,p=l[3]))));return p},o.process=function(){return L(),G(),R(),A()},function(){var e;for(e=0;e<i;e++)a[e][0]>>=d,a[e][1]>>=d,a[e][2]>>=d,a[e][3]=e}),Y=function(e,t,r,n,o){var c,u,s,l,p,f,d;for((s=t-e)<-1&&(s=-1),(l=t+e)>i&&(l=i),c=t+1,u=t-1,f=1;c<l||u>s;){if(p=T[f++],c<l){d=a[c++];try{d[0]-=p*(d[0]-r)/D,d[1]-=p*(d[1]-n)/D,d[2]-=p*(d[2]-o)/D}catch(m){}}if(u>s){d=a[u--];try{d[0]-=p*(d[0]-r)/D,d[1]-=p*(d[1]-n)/D,d[2]-=p*(d[2]-o)/D}catch(m){}}}},z=function(e,t,r,n,o){var i=a[t];i[0]-=e*(i[0]-r)/S,i[1]-=e*(i[1]-n)/S,i[2]-=e*(i[2]-o)/S},X=function(e,t,r){var n,o,c,u,s,l,p,f,m,g;for(m=f=~(1<<31),p=l=-1,n=0;n<i;n++)(o=(g=a[n])[0]-e)<0&&(o=-o),(c=g[1]-t)<0&&(c=-c),o+=c,(c=g[2]-r)<0&&(c=-c),(o+=c)<f&&(f=o,l=n),(u=o-(N[n]>>y-d))<m&&(m=u,p=n),s=F[n]>>h,F[n]-=s,N[n]+=s<<v;return F[l]+=b,N[l]-=w,p};return B.apply(this,arguments),o},ut=function(){for(var e=0,t={};e<256;e++)t[e]=String.fromCharCode(e);function r(){this.bin=[]}r.prototype.getData=function(){for(var e="",r=this.bin.length,n=0;n<r;n++)e+=t[this.bin[n]];return e},r.prototype.writeByte=function(e){this.bin.push(e)},r.prototype.writeUTFBytes=function(e){for(var t=e.length,r=0;r<t;r++)this.writeByte(e.charCodeAt(r))},r.prototype.writeBytes=function(e,t,r){for(var n=r||e.length,a=t||0;a<n;a++)this.writeByte(e[a])};var n,a,o,i,c,u,s,l,p,f={},d=null,m=-1,y=0,g=!1,v=[],h=7,b=-1,w=!1,O=!0,E=!1,j=10,_="Generated by jsgif (https://github.com/antimatter15/jsgif/)",x=(f.setDelay=function(e){y=Math.round(e/10)},f.setDispose=function(e){e>=0&&(b=e)},f.setRepeat=function(e){e>=0&&(m=e)},f.setTransparent=function(e){d=e},f.setComment=function(e){_=e},f.addFrame=function(e,t){if(null===e||!g||null===i)throw new Error("Please call start method before calling addFrame");var r=!0;try{t?e instanceof ImageData?(c=e.data,E&&n==e.width&&a==e.height||P(e.width,e.height)):e instanceof Uint8ClampedArray?e.length==n*a*4?c=e:(console.log("Please set the correct size: ImageData length mismatch"),r=!1):(console.log("Please provide correct input"),r=!1):(c=e.getImageData(0,0,e.canvas.width,e.canvas.height).data,E||P(e.canvas.width,e.canvas.height)),M(),S(),O&&(N(),T(),m>=0&&F()),C(),""!==_&&D(),k(),O||T(),A(),O=!1}catch(o){r=!1}return r},f.download=function(e){if(null===i||0==w)console.log("Please call start method and add frames and call finish method before calling download");else{e=void 0!==e?e.endsWith(".gif")?e:e+".gif":"download.gif";var t=document.createElement("a");t.download=e,t.href=URL.createObjectURL(new Blob([new Uint8Array(i.bin)],{type:"image/gif"})),t.click()}},f.finish=function(){if(!g)return!1;var e=!0;g=!1;try{i.writeByte(59),w=!0}catch(t){e=!1}return e},function(){o=0,c=null,u=null,s=null,p=null,w=!1,O=!0}),P=(f.setFrameRate=function(e){15!=e&&(y=Math.round(100/e))},f.setQuality=function(e){e<1&&(e=1),j=e},f.setSize=function(e,t){g&&!O||((n=e)<1&&(n=320),(a=t)<1&&(a=240),E=!0)}),S=(f.start=function(){x();var e=!0;w=!1,i=new r;try{i.writeUTFBytes("GIF89a")}catch(t){e=!1}return g=e},f.cont=function(){x();return w=!1,i=new r,g=!0},function(){var e=u.length,t=e/3;s=[];var r=new ct(u,e,j);p=r.process();for(var n=0,a=0;a<t;a++){var i=r.map(255&u[n++],255&u[n++],255&u[n++]);v[i]=!0,s[a]=i}u=null,l=8,h=7,null!==d&&(o=I(d))}),I=function(e){if(null===p)return-1;for(var t=(16711680&e)>>16,r=(65280&e)>>8,n=255&e,a=0,o=16777216,i=p.length,c=0;c<i;){var u=t-(255&p[c++]),s=r-(255&p[c++]),l=n-(255&p[c]),f=u*u+s*s+l*l,d=c/3;v[d]&&f<o&&(o=f,a=d),c++}return a},M=function(){var e=n,t=a;u=[];for(var r=c,o=0,i=0;i<t;i++)for(var s=0;s<e;s++){var l=i*e*4+4*s;u[o++]=r[l],u[o++]=r[l+1],u[o++]=r[l+2]}},C=function(){var e,t;i.writeByte(33),i.writeByte(249),i.writeByte(4),null===d?(e=0,t=0):(e=1,t=2),b>=0&&(t=7&b),t<<=2,i.writeByte(0|t|e),B(y),i.writeByte(o),i.writeByte(0)},D=function(){i.writeByte(33),i.writeByte(254),i.writeByte(_.length),i.writeUTFBytes(_),i.writeByte(0)},k=function(){i.writeByte(44),B(0),B(0),B(n),B(a),O?i.writeByte(0):i.writeByte(128|h)},N=function(){B(n),B(a),i.writeByte(240|h),i.writeByte(0),i.writeByte(0)},F=function(){i.writeByte(33),i.writeByte(255),i.writeByte(11),i.writeUTFBytes("NETSCAPE2.0"),i.writeByte(3),i.writeByte(1),B(m),i.writeByte(0)},T=function(){i.writeBytes(p);for(var e=768-p.length,t=0;t<e;t++)i.writeByte(0)},B=function(e){i.writeByte(255&e),i.writeByte(e>>8&255)},A=function(){new it(n,a,s,l).encode(i)};f.stream=function(){return i},f.setProperties=function(e,t){g=e,O=t};return f};function st(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=function(e){return{width:O(e)+16,height:b(e)+16}}(S(e)),a=document.createElement("canvas");a.width=n.width,a.height=n.height;var o=a.getContext("2d");return e.forEach(function(e){var r=S([e]);Object(f.a)(r).sort(function(e,t){return e.spriteMemoryIndex-t.spriteMemoryIndex}).forEach(function(e){e.tiles.forEach(function(r){var n=document.createElement("canvas"),a=r.tileIndex;3===r.autoAnimation&&(a=(-8&a)+(a+t&7)),2===r.autoAnimation&&(a=(-4&a)+(a+t&3)),A(n,a,r.rgbPalette),(r.horizontalFlip||r.verticalFlip)&&(n=function(e,t){var r=t.horizontalFlip?-1:1,n=t.verticalFlip?-1:1,a=t.horizontalFlip?e.width:0,o=t.verticalFlip?e.height:0,i=document.createElement("canvas");i.width=e.width,i.height=e.height;var c=i.getContext("2d");return c&&(c.save(),c.translate(a,o),c.scale(r,n),c.drawImage(e,0,0),c.restore()),i}(n,r)),o.drawImage(n,e.composedX,r.composedY)})})}),r?function(e,t){var r=t[1].x-t[0].x,n=t[1].y-t[0].y,a=document.createElement("canvas");return a.width=r,a.height=n,a.getContext("2d").drawImage(e,t[0].x,t[0].y,r,n,0,0,r,n),a}(a,r):a}var lt=0;function pt(e,t,r,n,a){var o=new ut;o.setRepeat(lt),o.setDelay(r),o.setQuality(1),o.start();var i=function(e){var t=P(e),r=Math.max.apply(Math,Object(f.a)(t.map(function(e){return e.autoAnimation})));return Math.pow(2,r)}(e),c=i,u=function(){o.finish();var e=o.stream().getData();a("data:image/gif;base64,".concat(btoa(e)))};!function r(){var a=i-c,s=st(e,a,t);o.addFrame(s.getContext("2d")),--c,n(s,a,i),c?setTimeout(r,1):setTimeout(u,1)}()}function ft(e){for(;e.firstChild;)e.removeChild(e.firstChild)}var dt=function(e){var t=e.isOpen,r=e.onRequestClose,o=Ce().state,c=Object(n.useRef)(null),u=Object(n.useState)(null),s=Object(p.a)(u,2),l=s[0],f=s[1];return Object(n.useEffect)(function(){if(t){var e=16*window.Module._get_neogeo_frame_counter_speed();pt(o.layers,o.crop,e,function(e,t,r){f({frame:t,totalFrames:r}),c&&c.current&&(ft(c.current),c.current.appendChild(e))},function(e){if(f(null),c&&c.current){ft(c.current);var t=new Image;t.src=e,c.current.appendChild(t)}})}},[t]),a.a.createElement(i.a,{isOpen:t,onRequestClose:r},l&&a.a.createElement("div",null,l.frame," of ",l.totalFrames),a.a.createElement("div",{ref:c}))},mt=r(52),yt=r.n(mt),gt=function(e){var t=e.layer,r=e.index,n=e.runPreview,o=e.animationCounter,i=e.canDrag,c=e.outlineTiles,u=Ce().state;if(u.hiddenLayers[t.id])return null;var s=t.groups.reduce(function(e,t){return u.hiddenGroups[t.id]?e:e.concat(t.sprites)},[]).map(function(e,t){return a.a.createElement(xe,{key:t,data:e,autoAnimate:n,animationCounter:o,canDrag:i,outlineTiles:c})}),l=S([t]),p=O(l),f=Math.max(p+48,320),d=b(l),m={zIndex:r,width:f,height:Math.max(d+48,240)};return a.a.createElement("div",{className:yt.a.root,style:m},s)},vt=r(17),ht=r.n(vt),bt=function(e){var t=e.className,r=e.crop,n=e.totalWidth,o=e.totalHeight,i=be()(ht.a.root,t),c={height:r[0].y,gridColumn:"1 / -1",gridRow:"1"},u={width:r[0].x,height:r[1].y-r[0].y,gridColumn:"1",gridRow:"2"},s={gridColumn:"3",gridRow:"2",width:n-r[1].x},l={width:r[1].x-r[0].x,height:r[1].y-r[0].y,gridColumn:"2",gridRow:"2"},p={gridColumn:"1 / -1",gridRow:"3",flex:"1",height:o-r[1].y};return a.a.createElement("div",{className:i},a.a.createElement("div",{className:ht.a.mask,style:c}),a.a.createElement("div",{className:ht.a.mask,style:u}),a.a.createElement("div",{className:ht.a.crop,style:l}),a.a.createElement("div",{className:ht.a.mask,style:s}),a.a.createElement("div",{className:ht.a.mask,style:p}))},wt=r(24),Ot=r.n(wt),Et=function(e){var t=e.className,r=Object(n.useState)({animation:0,rafFrameCountdown:0}),o=Object(p.a)(r,2),i=o[0],c=o[1],u=Object(n.useState)(!1),l=Object(p.a)(u,2),f=l[0],d=l[1],m=Object(n.useState)(!1),y=Object(p.a)(m,2),g=y[0],v=y[1],h=Ce(),w=h.state,E=h.dispatch,j=h.undo,_=h.redo,x=h.canUndo,P=h.canRedo,I=Object(n.useState)(null),M=Object(p.a)(I,2),C=M[0],D=M[1],k=Object(n.useState)(!1),N=Object(p.a)(k,2),F=N[0],T=N[1],B=Object(n.useState)(null),A=Object(p.a)(B,2),R=A[0],L=A[1],G=Object(n.useState)(null),Y=Object(p.a)(G,2),z=Y[0],X=Y[1];Object(n.useEffect)(function(){if(f){var e=window.Module._get_neogeo_frame_counter_speed()-1;requestAnimationFrame(function(){var t=0===i.rafFrameCountdown?1:0;c({animation:i.animation+t,rafFrameCountdown:1===t?e:i.rafFrameCountdown-1})})}});var U=Object(s.e)({accept:["Sprite","Sprites"],drop:function(e,t){if(C){var r=t.getClientOffset().x-C.getBoundingClientRect().left,n=16*Math.floor(r/16);if("Sprite"===e.type){var a=e.spriteMemoryIndex,o=e.pauseId;E(o?{type:"MoveSprite",spriteMemoryIndex:a,newComposedX:n,pauseId:o}:{type:"ExtractSprite",spriteMemoryIndex:a,composedX:n})}else E({type:"ExtractSpritesToGroup",spriteMemoryIndices:e.spriteMemoryIndices,composedX:n})}},canDrop:function(){return!F}}),V=Object(p.a)(U,2),H=(V[0],V[1]),Z=w.layers.map(function(e,t){return w.hiddenLayers[e.id]?null:a.a.createElement(gt,{key:t,index:t,layer:e,runPreview:f,animationCounter:i.animation,canDrag:!F,outlineTiles:w.showGrid})}),q={backgroundColor:w.isPaused?function(e){var t=K(e);return"rgb(".concat(t[0],", ").concat(t[1],", ").concat(t[2],")")}(function(){var e=window.Module._get_current_pal_addr();return e+=8190,e/=2,window.Module.HEAPU16[e]}()):"transparent"},Q=S(w.layers),W=O(Q),J=Math.max(W+48,320),$=b(Q),ee=Math.max($+48,240),te=be()(Ot.a.root,t);return a.a.createElement(a.a.Fragment,null,a.a.createElement(dt,{isOpen:g,onRequestClose:function(){return v(!1)}}),a.a.createElement("div",{className:te},a.a.createElement("div",{className:Ot.a.toolbar},a.a.createElement("button",{onClick:function(){return E({type:"ToggleGrid"})}},w.showGrid?"hide":"show"," grid"),a.a.createElement("button",{disabled:F,onClick:function(){T(!0),E({type:"ClearCrop"}),L(null),X(null)}},"crop"),a.a.createElement("button",{disabled:!w.crop,onClick:function(){E({type:"ClearCrop"}),L(null),X(null)}},"clear crop"),a.a.createElement("button",{onClick:function(){return d(!f)}},f?"stop":"preview"),a.a.createElement("button",{onClick:function(){return v(!0)}},"build gif"),a.a.createElement("button",{disabled:!x,onClick:function(){return j()}},"undo"),a.a.createElement("button",{disabled:!P,onClick:function(){return _()}},"redo"),a.a.createElement("button",{onClick:function(){return E({type:"PushAllDown"})}},"down")),a.a.createElement("div",{className:Ot.a.bg,ref:function(e){D(e),H(e)},style:q},F&&a.a.createElement("div",{className:Ot.a.captureLayer,onMouseDown:function(e){if(F){var t=e.target.getBoundingClientRect(),r=e.clientX-t.x,n=e.clientY-t.y,a=16*Math.floor(r/16),o=16*Math.floor(n/16);L({x:a,y:o})}},onMouseMove:function(e){if(F&&R){var t=e.target.getBoundingClientRect(),r=e.clientX-t.x,n=e.clientY-t.y,a=16*Math.floor(r/16),o=16*Math.floor(n/16);X({x:a,y:o})}},onMouseUp:function(e){F&&R&&z&&(E({type:"SetCrop",crop:[R,z]}),T(!1))}}),Z,!!(F&&R&&z||w.crop)&&a.a.createElement(bt,{className:Ot.a.cropRect,crop:w.crop||[R,z],totalWidth:J,totalHeight:ee}))))},jt=r(53),_t=r.n(jt),xt=function(e){var t=e.className,r=e.title,n=e.icon,o=e.onClick,i=n,c=be()(_t.a.root,t);return a.a.createElement(i,{className:c,onClick:o,title:r,"aria-role":"button","aria-label":r})},Pt=r(9),St=r(21),It=r.n(St),Mt=r(27),Ct=r.n(Mt),Dt=r(28),kt=r.n(Dt),Nt=r(55),Ft=r.n(Nt),Tt=r(54),Bt=r.n(Tt),At=function(e){var t=e.sprite,r=e.onDelete;return a.a.createElement("div",{className:Bt.a.root}," ",t.spriteMemoryIndex," ",a.a.createElement(xt,{icon:It.a,title:"Delete Layer",onClick:function(){return r()}}))};var Rt=a.a.memo(function(e){var t=function(e){var t=st([{id:0,groups:[k(e)]}]);return{url:t.toDataURL("image/png"),width:t.width,height:t.height}}(e.group),r=t.width,n=t.height,o=t.url,i=24/Math.max(r,n);return a.a.createElement("img",{width:r*i,height:n*i,src:o,alt:"sprite group thumbnail"})}),Lt=r(31),Gt=r.n(Lt),Yt=function(e){var t=e.group,r=e.onDelete,o=e.onToggleVisibility,i=Ce(),c=i.dispatch,u=i.state,s=Object(n.useState)(!1),l=Object(p.a)(s,2),f=l[0],d=l[1],m=null;return f&&(m=t.sprites.map(function(e,r){return a.a.createElement(At,{key:r,sprite:e,onDelete:function(){return c({type:"RemoveSpriteFromExtractedGroup",group:t,sprite:e})}})})),a.a.createElement("div",{className:Gt.a.root},a.a.createElement("div",{className:Gt.a.toolbar},a.a.createElement(xt,{icon:f?Ct.a:kt.a,title:"Show sprites",onClick:function(){return d(!f)}}),a.a.createElement(Rt,{group:t}),a.a.createElement("div",null,t.sprites[0]&&t.sprites[0].spriteMemoryIndex||"empty"),a.a.createElement(xt,{icon:u.hiddenGroups[t.id]?Pt.c:Pt.b,onClick:function(){return o()},title:"Group is ".concat(u.hiddenLayers[t.id]?"hidden":"visible")}),a.a.createElement(xt,{icon:It.a,title:"Delete Group",onClick:function(){return r()}})),a.a.createElement("div",{className:Gt.a.spriteContainer},m))},zt=a.a.memo(function(e){var t=function(e){var t=st([N(e)]);return{url:t.toDataURL("image/png"),width:t.width,height:t.height}}(e.layer),r=t.width,n=t.height,o=t.url,i=48/n;return a.a.createElement("img",{width:r*i,height:n*i,src:o,alt:"layer thumbnail"})}),Xt=r(37),Ut=r.n(Xt),Vt=function(e){var t=e.layer,r=e.onDelete,o=e.onToggleVisibility,i=e.onGroupDelete,c=e.onGroupToggleVisibility,u=e.onExtendViaMirror,s=e.onPushDown,l=Ce(),f=l.dispatch,d=l.state,m=Object(n.useState)(!0),y=Object(p.a)(m,2),g=y[0],v=y[1],h=t.groups.map(function(e,t){return a.a.createElement(Yt,{key:t,group:e,onDelete:function(){return i(e)},onToggleVisibility:function(){return c(e)}})});return a.a.createElement("div",{className:Ut.a.root},a.a.createElement("div",{className:Ut.a.toolbar},a.a.createElement(xt,{icon:g?Ct.a:kt.a,title:"Show groups",onClick:function(){return v(!g)}}),a.a.createElement(zt,{layer:t}),a.a.createElement(xt,{icon:Pt.e,onClick:function(){return f({type:"RotateLayer",layer:t})},title:"Rotate tiles"}),a.a.createElement(xt,{icon:Pt.d,onClick:function(){return u()},title:"Mirror"}),a.a.createElement(xt,{icon:Ft.a,onClick:function(){return s()},title:"Push Down"}),a.a.createElement(xt,{icon:d.hiddenLayers[t.id]?Pt.c:Pt.b,onClick:function(){return o()},title:"Layer is ".concat(d.hiddenLayers[t.id]?"hidden":"visible")}),a.a.createElement(xt,{icon:It.a,title:"Delete Layer",onClick:function(){return r()}})),g&&h)},Ht=r(38),Zt=r.n(Ht),qt=function(e){var t=e.className,r=Ce(),n=r.state,o=r.dispatch,i=be()(Zt.a.root,t),c=Object(f.a)(n.layers).reverse().map(function(e,t){return a.a.createElement(Vt,{key:t,layer:e,onDelete:function(){return o({type:"DeleteLayer",layer:e})},onToggleVisibility:function(){return o({type:"ToggleVisibilityOfLayer",layer:e})},onGroupDelete:function(e){return o({type:"DeleteGroup",group:e})},onGroupToggleVisibility:function(e){return o({type:"ToggleVisibilityOfGroup",group:e})},onExtendViaMirror:function(){return o({type:"ExtendLayerViaMirror",layer:e})},onPushDown:function(){return o({type:"PushDownLayer",layer:e})}})});return a.a.createElement("div",{className:i},a.a.createElement(xt,{className:Zt.a.buttonIcon,icon:Pt.a,onClick:function(){return o({type:"NewLayer"})},title:"New Layer"}),c)},Kt=r(12),Qt=r.n(Kt);r(78);i.a.setAppElement("#root"),u.a.render(a.a.createElement(function(){return a.a.createElement(ve,null,a.a.createElement(s.b,{backend:l.a},a.a.createElement(Ie,null),a.a.createElement("div",{className:Qt.a.app},a.a.createElement("div",{className:Qt.a.composeScreenTrayGrid},a.a.createElement(Et,{className:Qt.a.composeScreen}),a.a.createElement(ot,{className:Qt.a.spriteTray})),a.a.createElement("div",{className:Qt.a.emulatorLayersGrid},a.a.createElement(Ze,{className:Qt.a.emulator}),a.a.createElement(qt,{className:Qt.a.layers})))))},null),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.90b20b80.chunk.js.map