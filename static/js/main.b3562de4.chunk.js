(window.webpackJsonpngbg=window.webpackJsonpngbg||[]).push([[0],{10:function(e,t,n){e.exports={positioned:"tile_positioned__2WLPh"}},11:function(e,t,n){e.exports=n(17)},17:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(9),o=n.n(i),c=n(3),u=n.n(c),l=n(1),s=n(5),p=n(2),d=n(4),f=n.n(d),w=32;function m(e,t){if(0===t)return[0,0,0,0];for(var n=window.Module._get_current_pal_addr(),r=e*w,a=2*t,i=[],o=0;o<2;++o)i[o]=window.HEAPU8[n+r+a+o];return function(e){var t=e>>15&1;return[((e>>8&15)<<2|(e>>14&1)<<1|t)/63*255,((e>>4&15)<<2|(e>>13&1)<<1|t)/63*255,((15&e)<<2|(e>>12&1)<<1|t)/63*255,255]}(i[0]|i[1]<<8)}var v=n(10),y=n.n(v),g=128,b={0:3,1:2,2:1,3:0,4:7,5:6,6:5,7:4},h=function(e){var t=e.y,n=e.tileIndex,r=e.paletteIndex,i=e.horizontalFlip,o=e.verticalFlip,c=e.positioned;var u=o?-1:1,l={transform:"scale(".concat(i?-1:1,",").concat(u,")"),top:t},s=f()(Object(p.a)({},y.a.positioned,c));return a.a.createElement("canvas",{className:s,ref:function(e){return e&&function(e){for(var t=window.Module._get_rom_ctile_addr(),a=g*n,i=[],o=0;o<g;++o)i[o]=window.HEAPU8[t+a+o];e.width=16,e.height=16;for(var c=e.getContext("2d"),u=c.getImageData(0,0,16,16),l=0;l<16;++l)for(var s=0;s<8;++s)for(var p=i[8*l+b[s]],d=15&p,f=m(r,p>>4&15),w=m(r,d),v=0;v<f.length;++v)u.data[4*(16*l+2*s)+v]=f[v],u.data[4*(16*l+2*s+1)+v]=w[v];c.putImageData(u,0,0)}(e)},style:l})};function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var O=128,E=65536,x=66560,j=67584;function k(e,t,n){for(var r=window.Module._get_tile_ram_addr(),a=O*e,i=[],o=0;o<4*t;++o)i[o]=window.HEAPU8[r+a+o];for(var c=[],u=0;u<i.length;u+=4){var l=i[u]|i[u+1]<<8,s=i[u+2]|i[u+3]<<8,p=l|(s>>4&15)<<16,d=s>>8&255,f=!!(1&s),w=!!(2&s);c.push({y:n[u/4],tileIndex:p,paletteIndex:d,horizontalFlip:f,verticalFlip:w})}return c}function S(e){if(e<0)throw new Error("getYSpriteSizeSticky: sprite index under zero!");var t=window.Module._get_tile_ram_addr()+x+2*e,n=window.HEAPU8[t]|window.HEAPU8[t+1]<<8,r=!!(n>>6&1);if(r)return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(n,!0).forEach(function(t){Object(p.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},S(e-1),{sticky:r});for(var a=63&n,i=function(e,t,n){var r,a=512-e;if(a>272&&(a-=512),2===(r=32===n?1:n>=33?2:0)||1===r&&255===t)for(;a<0;)a+=t+1<<1;return a}(n>>7,A(e,{ignoreSticky:!0}).yScale,a),o=[],c=0;c<a;++c)o.push((i+16*c)%512);return{y:i,tileYs:o,spriteSize:a,sticky:r}}function P(e){if(e<0)throw new Error("getX: sprite index under zero!");var t;if(S(e).sticky){var n=A(e).xScale;t=P(e-1)+n}else{var r=window.Module._get_tile_ram_addr()+j+2*e;t=(window.HEAPU8[r]|window.HEAPU8[r+1]<<8)>>7}return t>=496&&(t-=512),t}function A(e,t){if(e<0)throw new Error("getScale: sprite index under zero!");if((!t||!t.ignoreSticky)&&S(e).sticky)return A(e-1);var n=window.Module._get_tile_ram_addr()+E+2*e,r=window.HEAPU8[n]|window.HEAPU8[n+1]<<8;return{yScale:255&r,xScale:1+(r>>8&15)}}var F=n(6),z=n.n(F),I=function(e){var t=e.spriteIndex,n=e.positioned,r=function(e,t){var n=S(e),r=n.y,a=n.tileYs,i=n.spriteSize;return{tiles:k(e,t?i:32,a),x:P(e),sticky:!1,y:r}}(t,e.honorTileSize);if(0===r.tiles.length)return null;var i=r.tiles.map(function(e,t){return a.a.createElement(h,{key:t,positioned:n,y:e.y-r.y,tileIndex:e.tileIndex,paletteIndex:e.paletteIndex,horizontalFlip:e.horizontalFlip,verticalFlip:e.verticalFlip})}),o={top:r.y,left:r.x,gridTemplateRows:"repeat(".concat(r.tiles.length,", 16px)")},c=f()(z.a.sprite,Object(p.a)({},z.a.positioned,n));return a.a.createElement("div",{className:c,style:o},i)},M=n(7),H=n.n(M),U=function(){var e=Object(r.useState)(0),t=Object(l.a)(e,2),n=t[0],i=t[1],o=Object(r.useState)(!0),c=Object(l.a)(o,2),u=c[0],s=c[1],d=Object(r.useState)(!0),w=Object(l.a)(d,2),m=w[0],v=w[1],y=new Array(n?448:0).fill(1,0,448).map(function(e,t){return a.a.createElement(I,{key:t,spriteIndex:t,positioned:u,honorTileSize:m})}),g=f()(H.a.sprites,Object(p.a)({},H.a.positioned,u));return a.a.createElement(a.a.Fragment,null,a.a.createElement("input",{type:"checkbox",checked:u,onChange:function(){return s(!u)}}),"positioned",a.a.createElement("input",{type:"checkbox",checked:m,onChange:function(){return v(!m)}}),"honor tile size",a.a.createElement("button",{onClick:function(){i(n+1)}},"dump sprites"),a.a.createElement("div",{className:g},y))};function C(e){return new Promise(function(t,n){var r=new FileReader;r.addEventListener("load",function(){r.result?t(r.result):n("Failed to load: ".concat(e.name))}),r.readAsArrayBuffer(e)})}function D(e){return T.apply(this,arguments)}function T(){return(T=Object(s.a)(u.a.mark(function e(t){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t);case 2:n=e.sent,window.Module.FS_createDataFile("/virtualfs",t.name,new Uint8Array(n),!0,!0);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var L=function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=(t[0],t[1]),i=Object(r.useState)(!1),o=Object(l.a)(i,2),c=(o[0],o[1]),p=Object(r.useState)(""),d=Object(l.a)(p,2),f=d[0],w=d[1],m=Object(r.useState)(!1),v=Object(l.a)(m,2),y=v[0],g=v[1];function b(){return(b=Object(s.a)(u.a.mark(function e(t){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.target&&t.target.files&&t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,D(r);case 5:n(!0);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(){return(h=Object(s.a)(u.a.mark(function e(t){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target&&t.target.files&&t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,D(n);case 5:c(!0),w(n.name.replace(".zip",""));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}return a.a.createElement(a.a.Fragment,null,a.a.createElement("canvas",{id:"canvas"}),a.a.createElement("div",null,"BIOS",a.a.createElement("input",{type:"file",onChange:function(e){return b.apply(this,arguments)}})),a.a.createElement("div",null,"ROM",a.a.createElement("input",{type:"file",onChange:function(e){return h.apply(this,arguments)}})),null,a.a.createElement("button",{onClick:function(){return function(e){var t=window.stackAlloc(12);window.HEAP32[t>>2]=window.allocateUTF8OnStack("gngeo"),window.HEAP32[1+(t>>2)]=window.allocateUTF8OnStack(e||f),window.HEAP32[2+(t>>2)]=0,window.Module._run_rom(2,t)}()}},"start emulation"),a.a.createElement("button",{onClick:function(){y?window.Module.resumeMainLoop():window.Module.pauseMainLoop(),g(!y)}},y?"resume":"pause"),a.a.createElement(U,null))};o.a.render(a.a.createElement(function(){return a.a.createElement(L,null)},null),document.getElementById("root"))},6:function(e,t,n){e.exports={sprite:"sprite_sprite__3KcA3",positioned:"sprite_positioned__3ip5P"}},7:function(e,t,n){e.exports={sprites:"sprites_sprites__1RtnD",positioned:"sprites_positioned__3qOrZ"}}},[[11,1,2]]]);
//# sourceMappingURL=main.b3562de4.chunk.js.map