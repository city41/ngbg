(window.webpackJsonpngbg=window.webpackJsonpngbg||[]).push([[0],{10:function(e,t,r){e.exports={root:"spriteEntry_root__21-Rc",hide:"spriteEntry_hide__1KLBL",index:"spriteEntry_index__3_j9A",focused:"spriteEntry_focused__2e2R9",spriteContainer:"spriteEntry_spriteContainer__3BESY",sprite:"spriteEntry_sprite__3D55Y"}},12:function(e,t,r){e.exports={root:"composeScreen_root__3bwon",layers:"composeScreen_layers__ioZ1g",toolbar:"composeScreen_toolbar__1QlS0",bg:"composeScreen_bg__1xmrl",handleNegatives:"composeScreen_handleNegatives__3RkzZ"}},13:function(e,t,r){e.exports={root:"layers_root__pN2-U",layer:"layers_layer__1JaOv",focused:"layers_focused__1aScK",group:"layers_group__2ZkQp"}},23:function(e,t,r){e.exports={root:"spriteTray_root__1Sixf",locked:"spriteTray_locked__Lvuwa",spriteEntries:"spriteTray_spriteEntries__16oai"}},27:function(e,t,r){e.exports={sprite:"sprite_sprite__38hI5",positioned:"sprite_positioned__16NC_"}},39:function(e,t,r){e.exports={root:"emulator_root__3kH7Z"}},40:function(e,t,r){e.exports={positioned:"tile_positioned__9EsHg"}},41:function(e,t,r){e.exports={root:"extractedTile_root__14wnu"}},42:function(e,t,r){e.exports={root:"extractedSprite_root__gpe6g"}},45:function(e,t,r){e.exports=r(68)},67:function(e,t,r){},68:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(15),i=r.n(o),c=r(25),u=r.n(c),s=r(11),l=r(7),f=r(43),p=r(2),d=r(3),y=r(6),m=r(44);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var h=128,g=65536,w=66560,b=67584;function O(e,t,r){for(var n=window.Module._get_tile_ram_addr(),a=h*e,o=[],i=0;i<4*t;++i)o[i]=window.HEAPU8[n+a+i];for(var c=[],u=0;u<o.length;u+=4){var s=o[u]|o[u+1]<<8,l=o[u+2]|o[u+3]<<8,f=s|(l>>4&15)<<16,p=0;8&l?p=3:4&l&&(p=2);var d=l>>8&255,y=!!(1&l),m=!!(2&l);c.push({y:r[u/4],tileIndex:f,paletteIndex:d,horizontalFlip:y,verticalFlip:m,autoAnimation:p})}return c}function E(e){if(e<0)throw new Error("getYSpriteSizeSticky: sprite index under zero!");var t=window.Module._get_tile_ram_addr()+w+2*e,r=window.HEAPU8[t]|window.HEAPU8[t+1]<<8,n=!!(r>>6&1);if(n)return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(r,!0).forEach(function(t){Object(d.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},E(e-1),{sticky:n});for(var a=63&r,o=function(e,t,r){var n,a=512-e;if(a>272&&(a-=512),2===(n=32===r?1:r>=33?2:0)||1===n&&255===t)for(;a<0;)a+=t+1<<1;return a}(r>>7,x(e,{ignoreSticky:!0}).yScale,a),i=[],c=0;c<a;++c)i.push((o+16*c)%512);return{y:o,tileYs:i,spriteSize:a,sticky:n}}function _(e){if(e<0)throw new Error("getX: sprite index under zero!");var t;if(E(e).sticky){var r=x(e).xScale;t=_(e-1)+r}else{var n=window.Module._get_tile_ram_addr()+b+2*e;t=(window.HEAPU8[n]|window.HEAPU8[n+1]<<8)>>7}return t>=496&&(t-=512),t}function x(e,t){if(e<0)throw new Error("getScale: sprite index under zero!");if((!t||!t.ignoreSticky)&&E(e).sticky)return x(e-1);var r=window.Module._get_tile_ram_addr()+g+2*e,n=window.HEAPU8[r]|window.HEAPU8[r+1]<<8;return{yScale:255&n,xScale:1+(n>>8&15)}}function j(e,t){var r=E(e),n=r.sticky,a=r.y,o=r.tileYs,i=r.spriteSize;return{tiles:O(e,t?i:32,o),x:_(e),sticky:n,y:a,spriteSize:i}}var I=16,P=2*I;function S(e){var t=e>>15&1;return[((e>>8&15)<<2|(e>>14&1)<<1|t)/63*255,((e>>4&15)<<2|(e>>13&1)<<1|t)/63*255,((15&e)<<2|(e>>12&1)<<1|t)/63*255,255]}function k(e){var t=(window.Module._get_current_pal_addr()+e*P)/2;return Object(y.a)(window.Module.HEAPU16.slice(t,t+I))}function C(e){var t=e.map(S);return[[0,0,0,0]].concat(Object(y.a)(t.slice(1)))}function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function F(e){var t=e.y,r=(e.paletteIndex,Object(m.a)(e,["y","paletteIndex"])),n=k(e.paletteIndex);return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(r,!0).forEach(function(t){Object(d.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},r,{composedY:t,neoGeoPalette:n,rgbPalette:C(n)})}function M(e,t,r){var n=function(e){for(var t=e,r=j(t,!0);r.sticky&&t>0;)r=j(t-=1,!0);var n=[];do{n.push(t),r=j(t+=1,!0)}while(r.sticky);return n}(e).map(function(e,r){var n=j(e,!0);return{spriteMemoryIndex:e,tiles:n.tiles.map(F),screenX:n.x,screenY:n.y,composedX:t+16*r,composedY:n.y}}),a={pauseId:r,sprites:n,hidden:!1};return n.forEach(function(e){return e.group=a}),a}var N=r(38);function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(r,!0).forEach(function(t){Object(d.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var T={hasStarted:!1,isPaused:!1,pauseId:0,layers:[],focusedLayerIndex:-1};function z(e){var t=e.reduce(function(e,t){var r=t.sprites.reduce(function(e,t){return e.concat(t.tiles)},[]);return e.concat(r)},[]),r=Math.min.apply(Math,Object(y.a)(t.map(function(e){return e.composedY})));if(r<0){var n=-1*r;t.forEach(function(e){return e.composedY+=n})}return e}function L(e,t){switch(t.type){case"StartEmulation":return D({},e,{hasStarted:!0});case"TogglePause":var r=!e.isPaused;return D({},e,{isPaused:r,pauseId:r?e.pauseId+1:e.pauseId});case"ExtractSprite":var n=t,a=n.spriteMemoryIndex,o=n.composedX,i=n.pauseId;if(i){var c=e.layers[e.focusedLayerIndex];if(!c)return e;var u=c.groups.find(function(e){return e.pauseId===i&&e.sprites.some(function(e){return e.spriteMemoryIndex===a})});return u?(function(e,t,r){var n=r-e.sprites[0].composedX;t.filter(function(t){return t.pauseId===e.pauseId}).forEach(function(e){e.sprites.forEach(function(e){e.composedX+=n})})}(u,c.groups,o),D({},e)):e}var s,l=M(a,o,e.pauseId),f=e.layers[e.focusedLayerIndex]||e.layers[e.layers.length-1]||{groups:[l],hidden:!1},p=f.groups.filter(function(e){return e.pauseId!==l.pauseId||!function(e,t){var r=e.sprites.map(function(e){return e.spriteMemoryIndex}).sort(),n=t.sprites.map(function(e){return e.spriteMemoryIndex}).sort();return Object(N.isEqual)(r,n)}(e,l)});return function(e,t){var r=t.find(function(t){return t.pauseId===e.pauseId});if(r){var n=r.sprites[0].composedX-r.sprites[0].screenX;e.sprites.forEach(function(e){return e.composedX=e.screenX+n})}}(l,p),s=0===e.layers.length?[f]:e.layers.map(function(e){return e===f?D({},f,{groups:[].concat(Object(y.a)(f.groups),[l])}):e}),D({},e,{layers:s,focusedLayerIndex:1===s.length?0:e.focusedLayerIndex});case"HandleNegatives":var d=e.layers.map(function(e){return D({},e,{groups:z(e.groups)})});return D({},e,{layers:d});case"DeleteGroup":var m=t.group,v=e.layers.map(function(e){if(e.groups.indexOf(m)>-1){var t=e.groups.filter(function(e){return e!==m});return D({},e,{groups:t})}return e});return D({},e,{layers:v});case"ToggleVisibilityOfGroup":var h=t.group,g=e.layers.map(function(e){if(e.groups.indexOf(h)>-1){var t=e.groups.map(function(e){return e===h?D({},e,{hidden:!e.hidden}):e});return D({},e,{groups:t})}return e});return D({},e,{layers:g});case"NewLayer":return D({},e,{layers:e.layers.concat({groups:[],hidden:!1}),focusedLayerIndex:e.layers.length});case"DeleteLayer":var w=t.layer;return D({},e,{layers:e.layers.filter(function(e){return e!==w}),focusedLayerIndex:-1});case"ToggleVisibilityOfLayer":var b=t.layer,O=e.layers.map(function(e){return e===b?D({},e,{hidden:!e.hidden}):e});return D({},e,{layers:O});case"SetFocusedLayer":var E=t.layer;return D({},e,{focusedLayerIndex:e.layers.indexOf(E)})}return function(e){throw new Error("Non exhaustive switch statement")}(t.type)}var U=Object(n.createContext)(T),R=Object(n.createContext)(function(){return 0}),H=function(e){var t=e.children,r=Object(n.useReducer)(L,T),o=Object(p.a)(r,2),i=o[0],c=o[1];return a.a.createElement(R.Provider,{value:c},a.a.createElement(U.Provider,{value:i},t))};function X(){return[Object(n.useContext)(U),Object(n.useContext)(R)]}var Y={type:"TogglePause"},G={type:"StartEmulation"};var V={type:"HandleNegatives"};var q={type:"NewLayer"};var Q=r(9),Z=r.n(Q),K=r(22),J=r(4),W=r.n(J),$=r(39),ee=r.n($);function te(e){return new Promise(function(t,r){var n=new FileReader;n.addEventListener("load",function(){n.result?t(n.result):r("Failed to load: ".concat(e.name))}),n.readAsArrayBuffer(e)})}function re(e){return ne.apply(this,arguments)}function ne(){return(ne=Object(K.a)(Z.a.mark(function e(t){var r;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te(t);case 2:r=e.sent,window.Module.FS_createDataFile("/virtualfs",t.name,new Uint8Array(r),!0,!0);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ae=function(e){var t=X(),r=Object(p.a)(t,2),o=r[0],i=r[1],c=Object(n.useState)(""),u=Object(p.a)(c,2),s=u[0];u[1];function l(){return(l=Object(K.a)(Z.a.mark(function e(t){var r;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.target&&t.target.files&&t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,re(r);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function f(){return(f=Object(K.a)(Z.a.mark(function e(t){var r;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.target&&t.target.files&&t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,re(r);case 5:d(r.name.replace(".zip",""));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function d(e){var t=window.stackAlloc(12);window.HEAP32[t>>2]=window.allocateUTF8OnStack("gngeo"),window.HEAP32[1+(t>>2)]=window.allocateUTF8OnStack(e||s),window.HEAP32[2+(t>>2)]=0,i(G),window.Module._run_rom(2,t)}var y=W()(ee.a.root,e.className);return a.a.createElement("div",{className:y},a.a.createElement("canvas",{id:"canvas"}),a.a.createElement("div",null,"BIOS",a.a.createElement("input",{type:"file",onChange:function(e){return l.apply(this,arguments)}})),a.a.createElement("div",null,"ROM",a.a.createElement("input",{type:"file",onChange:function(e){return f.apply(this,arguments)}})),null,a.a.createElement("button",{disabled:!o.hasStarted,onClick:function(){o.isPaused?window.Module.resumeMainLoop():window.Module.pauseMainLoop(),i(Y)}},o.isPaused?"resume":"pause"))},oe=r(17),ie=r(18),ce=r(20),ue=r(19),se=r(21),le=128,fe={0:3,1:2,2:1,3:0,4:7,5:6,6:5,7:4};function pe(e,t,r){for(var n=window.Module._get_rom_ctile_addr(),a=le*t,o=[],i=0;i<le;++i)o[i]=window.HEAPU8[n+a+i];e.width=16,e.height=16;for(var c=e.getContext("2d"),u=c.getImageData(0,0,16,16),s=0;s<16;++s)for(var l=0;l<8;++l)for(var f=o[8*s+fe[l]],p=15&f,d=r[f>>4&15],y=r[p],m=0;m<d.length;++m)u.data[4*(16*s+2*l)+m]=d[m],u.data[4*(16*s+2*l+1)+m]=y[m];c.putImageData(u,0,0)}var de=r(40),ye=r.n(de),me=function(e){function t(){return Object(oe.a)(this,t),Object(ce.a)(this,Object(ue.a)(t).apply(this,arguments))}return Object(se.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.props,t=e.y,r=e.tileIndex,n=e.paletteIndex,o=e.horizontalFlip,i=e.verticalFlip,c=e.positioned;var u=i?-1:1,s={transform:"scale(".concat(o?-1:1,",").concat(u,")"),top:t},l=W()(Object(d.a)({},ye.a.positioned,c));return a.a.createElement("canvas",{className:l,ref:function(e){return e&&function(e){var t=C(k(n));pe(e,r,t)}(e)},style:s})}}]),t}(a.a.PureComponent),ve=r(27),he=r.n(ve),ge=function(e){var t=e.className,r=e.spriteIndex,n=e.positioned,o=e.overrideX,i=e.honorTileSize,c=Object(l.c)({item:{spriteIndex:r,type:"Sprite"}}),u=Object(p.a)(c,2),s=(u[0],u[1]),f=j(r,i);if(0===f.tiles.length)return null;var y=f.tiles.map(function(e,t){return a.a.createElement(me,{key:t,positioned:n,y:e.y-f.y,tileIndex:e.tileIndex,paletteIndex:e.paletteIndex,horizontalFlip:e.horizontalFlip,verticalFlip:e.verticalFlip})}),m={top:f.y,left:"number"===typeof o?o:f.x,gridTemplateRows:"repeat(".concat(f.tiles.length,", 16px)"),zIndex:r},v=W()(he.a.sprite,t,Object(d.a)({},he.a.positioned,n));return a.a.createElement("div",{ref:s,className:v,style:m},y)},we=r(10),be=r.n(we),Oe=function(e){var t,r=e.className,n=e.spriteIndex,o=e.render,i=e.hideIfEmpty,c=e.focused,u=e.honorTileSize,s=e.onClick,l=W()(be.a.root,r,(t={},Object(d.a)(t,be.a.hide,o&&i&&function(e){return 0===E(e).spriteSize}(n)),Object(d.a)(t,be.a.focused,c),t));return a.a.createElement("div",{className:l,onClick:s},a.a.createElement("div",{className:be.a.index},n),a.a.createElement("div",{className:be.a.spriteContainer},o&&a.a.createElement(ge,{className:be.a.sprite,spriteIndex:n,positioned:!1,honorTileSize:u})))},Ee=r(23),_e=r.n(Ee);var xe=function(e){var t=e.className,r=X(),o=Object(p.a)(r,1)[0],i=Object(n.useState)([]),c=Object(p.a)(i,2),u=c[0],s=c[1],l=Object(n.useState)(null),f=Object(p.a)(l,2),y=f[0],m=f[1],v=W()(_e.a.root,t,Object(d.a)({},_e.a.locked,!o.isPaused));return a.a.createElement("div",{className:v},a.a.createElement("div",{key:o.pauseId,className:_e.a.spriteEntries,style:{gridTemplateColumns:"repeat(".concat(381,", max-content)")}},new Array(381).fill(1,0,381).map(function(e,t){return a.a.createElement(Oe,{key:t,spriteIndex:t,render:o.isPaused,hideIfEmpty:!0,onClick:function(e){if(e.ctrlKey)s(u.concat(t)),m(null);else if(e.shiftKey)if(null!==y||1===u.length){var r=Math.min(y||u[0],t),n=Math.max(y||u[0],t);s(function(e,t){var r=t-e+1;return new Array(r).fill(0,0,r).map(function(t,r){return r+e})}(r,n))}else s([t]),m(t);else s([t]),m(null)},focused:u.indexOf(t)>-1,honorTileSize:!0})})))},je=r(41),Ie=r.n(je),Pe=function(e){function t(){return Object(oe.a)(this,t),Object(ce.a)(this,Object(ue.a)(t).apply(this,arguments))}return Object(se.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.props,t=e.y,r=e.tileIndex,n=e.rgbPalette,o=e.horizontalFlip;var i=e.verticalFlip?-1:1,c={transform:"scale(".concat(o?-1:1,",").concat(i,")"),top:t};return a.a.createElement("canvas",{className:Ie.a.root,ref:function(e){return e&&void pe(e,r,n)},style:c})}}]),t}(a.a.PureComponent),Se=r(42),ke=r.n(Se),Ce=function(e){var t=e.data,r=e.autoAnimate,n=e.animationCounter,o=Object(l.c)({item:{spriteIndex:t.spriteMemoryIndex,pauseId:t.group.pauseId,type:"Sprite"}}),i=Object(p.a)(o,2),c=(i[0],i[1]),u=t.tiles.map(function(e,o){var i=e.tileIndex;return r&&"number"===typeof n&&(3===e.autoAnimation&&(i=(-8&i)+(i+n&7)),2===e.autoAnimation&&(i=(-4&i)+(i+n&3))),a.a.createElement(Pe,{key:o,y:e.composedY-t.composedY,tileIndex:i,rgbPalette:e.rgbPalette,horizontalFlip:e.horizontalFlip,verticalFlip:e.verticalFlip})}),s={top:t.composedY,left:t.composedX,gridTemplateRows:"repeat(".concat(t.tiles.length,", 16px)"),zIndex:t.spriteMemoryIndex};return a.a.createElement("div",{ref:c,className:ke.a.root,style:s},u)},Be=function(){var e,t,r,n,a,o,i,c,u,s,l,f,p={},d=-1,y=12,m=5003,v=y,h=1<<y,g=[],w=[],b=m,O=0,E=!1,_=0,x=0,j=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],I=[],P=p.LZWEncoder=function(a,o,i,c){e=a,t=o,r=i,n=Math.max(2,c)},S=function(e,t){I[f++]=e,f>=254&&F(t)},k=function(e){C(b),O=s+2,E=!0,A(s,e)},C=function(e){for(var t=0;t<e;++t)g[t]=-1},B=p.compress=function(e,t){var r,n,a,o,p,y,m;for(E=!1,c=M(i=u=e),l=(s=1<<e-1)+1,O=s+2,f=0,o=N(),m=0,r=b;r<65536;r*=2)++m;m=8-m,C(y=b),A(s,t);e:for(;(a=N())!=d;)if(r=(a<<v)+o,g[n=a<<m^o]!=r){if(g[n]>=0){p=y-n,0===n&&(p=1);do{if((n-=p)<0&&(n+=y),g[n]==r){o=w[n];continue e}}while(g[n]>=0)}A(o,t),o=a,O<h?(w[n]=O++,g[n]=r):k(t)}else o=w[n];A(o,t),A(l,t)},F=(p.encode=function(r){r.writeByte(n),a=e*t,o=0,B(n+1,r),r.writeByte(0)},function(e){f>0&&(e.writeByte(f),e.writeBytes(I,0,f),f=0)}),M=function(e){return(1<<e)-1},N=function(){return 0===a?d:(--a,255&r[o++])},A=function(e,t){for(_&=j[x],x>0?_|=e<<x:_=e,x+=i;x>=8;)S(255&_,t),_>>=8,x-=8;if((O>c||E)&&(E?(c=M(i=u),E=!1):c=++i==v?h:M(i)),e==l){for(;x>0;)S(255&_,t),_>>=8,x-=8;F(t)}};return P.apply(this,arguments),p},Fe=function(){var e,t,r,n,a,o={},i=256,c=499,u=491,s=487,l=503,f=3*l,p=i-1,d=4,y=100,m=16,v=1<<m,h=10,g=10,w=v>>g,b=v<<h-g,O=i>>3,E=6,_=1<<E,x=O*_,j=30,I=10,P=1<<I,S=8,k=1<<S,C=I+S,B=1<<C,F=[],M=[],N=[],A=[],D=o.NeuQuant=function(e,o,c){var u,s;for(t=e,r=o,n=c,a=new Array(i),u=0;u<i;u++)a[u]=new Array(4),(s=a[u])[0]=s[1]=s[2]=(u<<d+8)/i,N[u]=v/i,M[u]=0},T=function(){for(var e=[],t=new Array(i),r=0;r<i;r++)t[a[r][3]]=r;for(var n=0,o=0;o<i;o++){var c=t[o];e[n++]=a[c][0],e[n++]=a[c][1],e[n++]=a[c][2]}return e},z=function(){var e,t,r,n,o,c,u,s;for(u=0,s=0,e=0;e<i;e++){for(r=e,n=(o=a[e])[1],t=e+1;t<i;t++)(c=a[t])[1]<n&&(r=t,n=c[1]);if(c=a[r],e!=r&&(t=c[0],c[0]=o[0],o[0]=t,t=c[1],c[1]=o[1],o[1]=t,t=c[2],c[2]=o[2],o[2]=t,t=c[3],c[3]=o[3],o[3]=t),n!=u){for(F[u]=s+e>>1,t=u+1;t<n;t++)F[t]=e;u=n,s=e}}for(F[u]=s+p>>1,t=u+1;t<256;t++)F[t]=p},L=function(){var a,o,i,p,m,v,h,g,w,b,O,_,I,S;for(r<f&&(n=1),e=30+(n-1)/3,_=t,I=0,S=r,b=(O=r/(3*n))/y|0,g=P,(h=(v=x)>>E)<=1&&(h=0),a=0;a<h;a++)A[a]=g*((h*h-a*a)*k/(h*h));for(w=r<f?3:r%c!==0?3*c:r%u!==0?3*u:r%s!==0?3*s:3*l,a=0;a<O;)if(i=(255&_[I+0])<<d,p=(255&_[I+1])<<d,m=(255&_[I+2])<<d,o=X(i,p,m),H(g,o,i,p,m),0!==h&&R(h,o,i,p,m),(I+=w)>=S&&(I-=r),0===b&&(b=1),++a%b===0)for(g-=g/e,(h=(v-=v/j)>>E)<=1&&(h=0),o=0;o<h;o++)A[o]=g*((h*h-o*o)*k/(h*h))},U=(o.map=function(e,t,r){var n,o,c,u,s,l,f;for(s=1e3,f=-1,o=(n=F[t])-1;n<i||o>=0;)n<i&&((c=(l=a[n])[1]-t)>=s?n=i:(n++,c<0&&(c=-c),(u=l[0]-e)<0&&(u=-u),(c+=u)<s&&((u=l[2]-r)<0&&(u=-u),(c+=u)<s&&(s=c,f=l[3])))),o>=0&&((c=t-(l=a[o])[1])>=s?o=-1:(o--,c<0&&(c=-c),(u=l[0]-e)<0&&(u=-u),(c+=u)<s&&((u=l[2]-r)<0&&(u=-u),(c+=u)<s&&(s=c,f=l[3]))));return f},o.process=function(){return L(),U(),z(),T()},function(){var e;for(e=0;e<i;e++)a[e][0]>>=d,a[e][1]>>=d,a[e][2]>>=d,a[e][3]=e}),R=function(e,t,r,n,o){var c,u,s,l,f,p,d;for((s=t-e)<-1&&(s=-1),(l=t+e)>i&&(l=i),c=t+1,u=t-1,p=1;c<l||u>s;){if(f=A[p++],c<l){d=a[c++];try{d[0]-=f*(d[0]-r)/B,d[1]-=f*(d[1]-n)/B,d[2]-=f*(d[2]-o)/B}catch(y){}}if(u>s){d=a[u--];try{d[0]-=f*(d[0]-r)/B,d[1]-=f*(d[1]-n)/B,d[2]-=f*(d[2]-o)/B}catch(y){}}}},H=function(e,t,r,n,o){var i=a[t];i[0]-=e*(i[0]-r)/P,i[1]-=e*(i[1]-n)/P,i[2]-=e*(i[2]-o)/P},X=function(e,t,r){var n,o,c,u,s,l,f,p,y,v;for(y=p=~(1<<31),f=l=-1,n=0;n<i;n++)(o=(v=a[n])[0]-e)<0&&(o=-o),(c=v[1]-t)<0&&(c=-c),o+=c,(c=v[2]-r)<0&&(c=-c),(o+=c)<p&&(p=o,l=n),(u=o-(M[n]>>m-d))<y&&(y=u,f=n),s=N[n]>>g,N[n]-=s,M[n]+=s<<h;return N[l]+=w,M[l]-=b,f};return D.apply(this,arguments),o},Me=function(){for(var e=0,t={};e<256;e++)t[e]=String.fromCharCode(e);function r(){this.bin=[]}r.prototype.getData=function(){for(var e="",r=this.bin.length,n=0;n<r;n++)e+=t[this.bin[n]];return e},r.prototype.writeByte=function(e){this.bin.push(e)},r.prototype.writeUTFBytes=function(e){for(var t=e.length,r=0;r<t;r++)this.writeByte(e.charCodeAt(r))},r.prototype.writeBytes=function(e,t,r){for(var n=r||e.length,a=t||0;a<n;a++)this.writeByte(e[a])};var n,a,o,i,c,u,s,l,f,p={},d=null,y=-1,m=0,v=!1,h=[],g=7,w=-1,b=!1,O=!0,E=!1,_=10,x="Generated by jsgif (https://github.com/antimatter15/jsgif/)",j=(p.setDelay=function(e){m=Math.round(e/10)},p.setDispose=function(e){e>=0&&(w=e)},p.setRepeat=function(e){e>=0&&(y=e)},p.setTransparent=function(e){d=e},p.setComment=function(e){x=e},p.addFrame=function(e,t){if(null===e||!v||null===i)throw new Error("Please call start method before calling addFrame");var r=!0;try{t?e instanceof ImageData?(c=e.data,E&&n==e.width&&a==e.height||I(e.width,e.height)):e instanceof Uint8ClampedArray?e.length==n*a*4?c=e:(console.log("Please set the correct size: ImageData length mismatch"),r=!1):(console.log("Please provide correct input"),r=!1):(c=e.getImageData(0,0,e.canvas.width,e.canvas.height).data,E||I(e.canvas.width,e.canvas.height)),k(),P(),O&&(M(),A(),y>=0&&N()),C(),""!==x&&B(),F(),O||A(),T(),O=!1}catch(o){r=!1}return r},p.download=function(e){if(null===i||0==b)console.log("Please call start method and add frames and call finish method before calling download");else{e=void 0!==e?e.endsWith(".gif")?e:e+".gif":"download.gif";var t=document.createElement("a");t.download=e,t.href=URL.createObjectURL(new Blob([new Uint8Array(i.bin)],{type:"image/gif"})),t.click()}},p.finish=function(){if(!v)return!1;var e=!0;v=!1;try{i.writeByte(59),b=!0}catch(t){e=!1}return e},function(){o=0,c=null,u=null,s=null,f=null,b=!1,O=!0}),I=(p.setFrameRate=function(e){15!=e&&(m=Math.round(100/e))},p.setQuality=function(e){e<1&&(e=1),_=e},p.setSize=function(e,t){v&&!O||((n=e)<1&&(n=320),(a=t)<1&&(a=240),E=!0)}),P=(p.start=function(){j();var e=!0;b=!1,i=new r;try{i.writeUTFBytes("GIF89a")}catch(t){e=!1}return v=e},p.cont=function(){j();return b=!1,i=new r,v=!0},function(){var e=u.length,t=e/3;s=[];var r=new Fe(u,e,_);f=r.process();for(var n=0,a=0;a<t;a++){var i=r.map(255&u[n++],255&u[n++],255&u[n++]);h[i]=!0,s[a]=i}u=null,l=8,g=7,null!==d&&(o=S(d))}),S=function(e){if(null===f)return-1;for(var t=(16711680&e)>>16,r=(65280&e)>>8,n=255&e,a=0,o=16777216,i=f.length,c=0;c<i;){var u=t-(255&f[c++]),s=r-(255&f[c++]),l=n-(255&f[c]),p=u*u+s*s+l*l,d=c/3;h[d]&&p<o&&(o=p,a=d),c++}return a},k=function(){var e=n,t=a;u=[];for(var r=c,o=0,i=0;i<t;i++)for(var s=0;s<e;s++){var l=i*e*4+4*s;u[o++]=r[l],u[o++]=r[l+1],u[o++]=r[l+2]}},C=function(){var e,t;i.writeByte(33),i.writeByte(249),i.writeByte(4),null===d?(e=0,t=0):(e=1,t=2),w>=0&&(t=7&w),t<<=2,i.writeByte(0|t|e),D(m),i.writeByte(o),i.writeByte(0)},B=function(){i.writeByte(33),i.writeByte(254),i.writeByte(x.length),i.writeUTFBytes(x),i.writeByte(0)},F=function(){i.writeByte(44),D(0),D(0),D(n),D(a),O?i.writeByte(0):i.writeByte(128|g)},M=function(){D(n),D(a),i.writeByte(240|g),i.writeByte(0),i.writeByte(0)},N=function(){i.writeByte(33),i.writeByte(255),i.writeByte(11),i.writeUTFBytes("NETSCAPE2.0"),i.writeByte(3),i.writeByte(1),D(y),i.writeByte(0)},A=function(){i.writeBytes(f);for(var e=768-f.length,t=0;t<e;t++)i.writeByte(0)},D=function(e){i.writeByte(255&e),i.writeByte(e>>8&255)},T=function(){new Be(n,a,s,l).encode(i)};p.stream=function(){return i},p.setProperties=function(e,t){v=e,O=t};return p};function Ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,a=e.reduce(function(e,t){return e.concat(t.sprites)},[]),o=function(e){var t=Math.max.apply(Math,Object(y.a)(e.map(function(e){return e.composedX})))+16,r=e.reduce(function(e,t){return e.concat(t.tiles)},[]);return{width:t,height:Math.max.apply(Math,Object(y.a)(r.map(function(e){return e.composedY})))+16}}(a),i=document.createElement("canvas");i.width=r||o.width,i.height=n||o.height;var c=i.getContext("2d");return Object(y.a)(a).sort(function(e,t){return e.spriteMemoryIndex-t.spriteMemoryIndex}).forEach(function(e){e.tiles.forEach(function(r){var n=document.createElement("canvas"),a=r.tileIndex;3===r.autoAnimation&&(a=(-8&a)+(a+t&7)),2===r.autoAnimation&&(a=(-4&a)+(a+t&3)),pe(n,a,r.rgbPalette),(r.horizontalFlip||r.verticalFlip)&&(n=function(e,t){var r=t.horizontalFlip?-1:1,n=t.verticalFlip?-1:1,a=t.horizontalFlip?e.width:0,o=t.verticalFlip?e.height:0,i=document.createElement("canvas");i.width=e.width,i.height=e.height;var c=i.getContext("2d");return c&&(c.save(),c.translate(a,o),c.scale(r,n),c.drawImage(e,0,0),c.restore()),i}(n,r)),c.drawImage(n,e.composedX,r.composedY)})}),i}var Ae=8,De=0;function Te(e){for(;e.firstChild;)e.removeChild(e.firstChild)}var ze=function(e){var t=e.isOpen,r=e.onRequestClose,o=X(),c=Object(p.a)(o,1)[0],u=Object(n.useRef)(null),s=Object(n.useState)(null),l=Object(p.a)(s,2),f=l[0],d=l[1];return Object(n.useEffect)(function(){if(t){var e=16*window.Module._get_neogeo_frame_counter_speed();!function(e,t,r,n,a,o){var i=new Me;i.setRepeat(De),i.setDelay(n),i.setQuality(1),i.start();var c=Ae,u=function(){i.finish();var e=i.stream().getData();o("data:image/gif;base64,".concat(btoa(e)))};!function n(){var o=Ae-c,s=Ne(e,o,t,r);i.addFrame(s.getContext("2d")),--c,a(s,o,Ae),c?setTimeout(n,1):setTimeout(u,1)}()}(c.layers.reduce(function(e,t){return e.concat(t.groups)},[]),640,480,e,function(e,t,r){d({frame:t,totalFrames:r}),u&&u.current&&(Te(u.current),u.current.appendChild(e))},function(e){if(d(null),u&&u.current){Te(u.current);var t=new Image;t.src=e,u.current.appendChild(t)}})}},[t]),a.a.createElement(i.a,{isOpen:t,onRequestClose:r},f&&a.a.createElement("div",null,f.frame," of ",f.totalFrames),a.a.createElement("div",{ref:u}))},Le=r(13),Ue=r.n(Le),Re=function(e){var t=e.group,r=e.onDelete,n=e.onToggleVisibility;return a.a.createElement("div",{className:Ue.a.group},t.sprites[0].spriteMemoryIndex," ",a.a.createElement("button",{onClick:function(){return r()}},"delete"),a.a.createElement("button",{onClick:function(){return n()}},t.hidden?"show":"hide"))},He=function(e){var t=e.layer,r=e.onDelete,n=e.onToggleVisibility,o=e.onGroupDelete,i=e.onGroupToggleVisibility,c=e.onClick,u=e.focused,s=t.groups.map(function(e,t){return a.a.createElement(Re,{key:t,group:e,onDelete:function(){return o(e)},onToggleVisibility:function(){return i(e)}})}),l=W()(Ue.a.layer,Object(d.a)({},Ue.a.focused,u));return a.a.createElement("div",{className:l,onClick:function(){return c()}},a.a.createElement("div",null,"layer",a.a.createElement("button",{onClick:function(){return r()}},"delete"),a.a.createElement("button",{onClick:function(){return n()}},t.hidden?"show":"hide")),s)},Xe=function(e){var t=e.className,r=X(),n=Object(p.a)(r,2),o=n[0],i=n[1],c=W()(Ue.a.root,t),u=o.layers.map(function(e,t){return a.a.createElement(He,{key:t,layer:e,focused:t===o.focusedLayerIndex,onClick:function(){return i(function(e){return{type:"SetFocusedLayer",layer:e}}(e))},onDelete:function(){return i(function(e){return{type:"DeleteLayer",layer:e}}(e))},onToggleVisibility:function(){return i(function(e){return{type:"ToggleVisibilityOfLayer",layer:e}}(e))},onGroupDelete:function(e){return i(function(e){return{type:"DeleteGroup",group:e}}(e))},onGroupToggleVisibility:function(e){return i(function(e){return{type:"ToggleVisibilityOfGroup",group:e}}(e))}})});return a.a.createElement("div",{className:c},a.a.createElement("button",{onClick:function(){return i(q)}},"new layer"),u)},Ye=r(12),Ge=r.n(Ye),Ve=function(e){var t=e.className,r=Object(n.useState)({animation:0,rafFrameCountdown:0}),o=Object(p.a)(r,2),i=o[0],c=o[1],u=Object(n.useState)(!1),s=Object(p.a)(u,2),f=s[0],d=s[1],m=Object(n.useState)(!1),v=Object(p.a)(m,2),h=v[0],g=v[1],w=X(),b=Object(p.a)(w,2),O=b[0],E=b[1],_=Object(n.useState)(null),x=Object(p.a)(_,2),j=x[0],I=x[1];Object(n.useEffect)(function(){if(f){var e=window.Module._get_neogeo_frame_counter_speed()-1;requestAnimationFrame(function(){var t=0===i.rafFrameCountdown?1:0;c({animation:i.animation+t,rafFrameCountdown:1===t?e:i.rafFrameCountdown-1})})}});var P=Object(l.d)({accept:"Sprite",drop:function(e,t){if(j){var r=t.getClientOffset().x-j.getBoundingClientRect().left,n=16*Math.floor(r/16),a=e.spriteIndex,o=e.pauseId;E(function(e,t,r){return{type:"ExtractSprite",spriteMemoryIndex:e,composedX:t,pauseId:r}}(a,n,o))}}}),k=Object(p.a)(P,2),C=(k[0],k[1]),B=O.layers.reduce(function(e,t){if(t.hidden)return e;var r=t.groups.reduce(function(e,t){return t.hidden?e:e.concat(t.sprites)},[]);return e.concat(r)},[]),F=B.map(function(e){return a.a.createElement(Ce,{key:e.spriteMemoryIndex,data:e,autoAnimate:f,animationCounter:i.animation})}),M=O.isPaused?function(e){var t=S(e);return"rgb(".concat(t[0],", ").concat(t[1],", ").concat(t[2],")")}(function(){var e=window.Module._get_current_pal_addr();return e+=8190,e/=2,window.Module.HEAPU16[e]}()):"transparent",N=Math.max.apply(Math,[0].concat(Object(y.a)(B.map(function(e){return e.composedX})))),A={backgroundColor:M,width:Math.max(N+48,320)},D=W()(Ge.a.root,t);return a.a.createElement(a.a.Fragment,null,a.a.createElement(ze,{isOpen:h,onRequestClose:function(){return g(!1)}}),a.a.createElement("div",{className:D},a.a.createElement("div",{className:Ge.a.toolbar},a.a.createElement("button",{onClick:function(){return d(!f)}},f?"stop":"preview"),a.a.createElement("button",{onClick:function(){return g(!0)}},"build gif"),a.a.createElement("div",null,i.animation," (",i.rafFrameCountdown,")")),a.a.createElement(Xe,{className:Ge.a.layers}),a.a.createElement("div",{className:Ge.a.bg,ref:function(e){I(e),C(e)},style:A},F),a.a.createElement("button",{className:Ge.a.handleNegatives,onClick:function(){return E(V)}},"handle negatives")))};r(67);i.a.setAppElement("#root"),u.a.render(a.a.createElement(function(){return a.a.createElement(H,null,a.a.createElement(l.b,{backend:f.a},a.a.createElement(s.d,null,a.a.createElement(s.c,{size:"50%"},a.a.createElement(s.b,{size:"30%"},a.a.createElement(ae,null)),a.a.createElement(s.a,null,a.a.createElement(Ve,null))),a.a.createElement(s.a,null,a.a.createElement(xe,null)))))},null),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.3b22cee8.chunk.js.map